import{u as w,a as S,r as i,j as e,B as y}from"./index-B56gB6y7.js";import{c as k}from"./projectService-BXfW4tyv.js";import{c as D,u as U}from"./imageUploadService-CzeZbtt7.js";import{C as E}from"./Card-CxEH0R_p.js";import{I as p}from"./Input-C6ykoCPd.js";const A=()=>{const u=w(),{currentUser:b}=S(),[c,d]=i.useState(!1),[s,h]=i.useState(!1),[x,o]=i.useState(""),[v,j]=i.useState(null),[a,m]=i.useState({name:"",startDate:"",estimatedCost:"",status:"ongoing",projectImageUrl:""}),g=r=>{const{name:t,value:n}=r.target;m(l=>({...l,[t]:n})),o("")},f=async r=>{const t=r.target.files[0];if(t){h(!0),o("");try{const n=await D(t),l=await U(n);l.success?(m(P=>({...P,projectImageUrl:l.url})),j(l.url),console.log("âœ… Image uploaded successfully")):o(l.error||"Failed to upload image")}catch(n){console.error("Error uploading image:",n),o("Failed to upload image. Please try again.")}finally{h(!1)}}},C=()=>{m(r=>({...r,projectImageUrl:""})),j(null)},I=async r=>{r.preventDefault(),d(!0),o("");try{if(!a.name||!a.startDate){o("Please fill in all required fields"),d(!1);return}const t=await k({name:a.name,startDate:a.startDate,estimatedCost:a.estimatedCost||0,status:a.status,projectImageUrl:a.projectImageUrl,userId:b.uid});t.success?(console.log("âœ… Project created successfully"),u("/")):o(t.error||"Failed to create project")}catch(t){console.error("Error creating project:",t),o("An unexpected error occurred. Please try again.")}finally{d(!1)}};return e.jsxs("div",{children:[e.jsx("h1",{style:{marginBottom:"var(--spacing-xl)"},children:"Add New Project"}),e.jsx(E,{children:e.jsxs("form",{onSubmit:I,children:[x&&e.jsx("div",{style:{padding:"var(--spacing-md)",backgroundColor:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--color-danger)",borderRadius:"var(--radius-md)",color:"var(--color-danger)",marginBottom:"var(--spacing-lg)"},children:x}),e.jsx(p,{label:"Project Name",type:"text",name:"name",value:a.name,onChange:g,placeholder:"Enter project name",required:!0}),e.jsx(p,{label:"Start Date",type:"date",name:"startDate",value:a.startDate,onChange:g,required:!0}),e.jsx(p,{label:"Estimated Cost (â‚¹)",type:"number",name:"estimatedCost",value:a.estimatedCost,onChange:g,placeholder:"Enter estimated cost",min:"0",step:"1"}),e.jsxs("div",{style:{marginBottom:"var(--spacing-lg)"},children:[e.jsx("label",{style:{display:"block",marginBottom:"var(--spacing-sm)",fontSize:"0.875rem",fontWeight:"600",color:"var(--color-text-primary)"},children:"Project Image (Optional)"}),e.jsx("p",{style:{fontSize:"0.75rem",color:"var(--color-text-tertiary)",marginBottom:"var(--spacing-sm)"},children:"This image will be used as the project header background"}),v?e.jsxs("div",{style:{position:"relative",width:"100%",maxWidth:"400px",borderRadius:"var(--radius-md)",overflow:"hidden",marginBottom:"var(--spacing-sm)"},children:[e.jsx("img",{src:v,alt:"Project preview",style:{width:"100%",height:"200px",objectFit:"cover",display:"block"}}),e.jsx("button",{type:"button",onClick:C,style:{position:"absolute",top:"8px",right:"8px",padding:"8px 12px",backgroundColor:"rgba(0,0,0,0.7)",color:"white",border:"none",borderRadius:"6px",fontSize:"0.875rem",fontWeight:"600",cursor:"pointer"},children:"âœ• Remove"})]}):e.jsxs("div",{children:[e.jsx("input",{type:"file",accept:"image/*",capture:"environment",onChange:f,disabled:s,style:{display:"none"},id:"project-image-upload"}),e.jsx("label",{htmlFor:"project-image-upload",style:{display:"inline-flex",alignItems:"center",gap:"var(--spacing-sm)",padding:"12px 24px",backgroundColor:s?"#f5f5f5":"var(--color-bg-secondary)",border:"2px dashed var(--color-border)",borderRadius:"var(--radius-md)",fontSize:"0.875rem",fontWeight:"600",color:"var(--color-text-secondary)",cursor:s?"not-allowed":"pointer",transition:"all 0.2s ease"},onMouseEnter:r=>{s||(r.currentTarget.style.borderColor="var(--color-primary)",r.currentTarget.style.backgroundColor="rgba(59, 130, 246, 0.05)")},onMouseLeave:r=>{r.currentTarget.style.borderColor="var(--color-border)",r.currentTarget.style.backgroundColor="var(--color-bg-secondary)"},children:s?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"â³"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"ðŸ“·"}),"Upload Project Image"]})})]})]}),e.jsxs("div",{style:{display:"flex",gap:"var(--spacing-md)",marginTop:"var(--spacing-xl)"},children:[e.jsx(y,{type:"submit",variant:"primary",size:"large",loading:c,disabled:s,children:c?"Creating...":"Create Project"}),e.jsx(y,{type:"button",variant:"outline",size:"large",onClick:()=>u("/"),disabled:c||s,children:"Cancel"})]})]})})]})};export{A as default};
