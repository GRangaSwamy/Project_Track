import{q as g,c as l,d as t,w as h,o as f,k as i,g as u,l as p,h as m,f as y,s as d,m as P}from"./index-B56gB6y7.js";import{d as w}from"./Card-CxEH0R_p.js";const c="projects",q=async e=>{try{if(!e.userId)throw new Error("User ID is required to create a project");const s=await y(l(t,c),{name:e.name,startDate:e.startDate,estimatedCost:parseFloat(e.estimatedCost)||0,status:e.status||"ongoing",projectImageUrl:e.projectImageUrl||"",userId:e.userId,createdAt:d(),updatedAt:d()});return console.log("âœ… Project created:",s.id),{success:!0,id:s.id}}catch(s){return console.error("âŒ Error creating project:",s),{success:!1,error:s.message}}},A=async e=>{var s;try{if(!e)throw new Error("User ID is required to fetch projects");const r=g(l(t,c),h("userId","==",e),f("createdAt","desc")),a=await i(r),o=[];return a.forEach(n=>{o.push({id:n.id,...n.data()})}),console.log("âœ… Fetched projects:",o.length),{success:!0,data:o}}catch(r){return console.error("âŒ Error fetching projects:",r),r.code==="failed-precondition"||(s=r.message)!=null&&s.includes("requires an index")?{success:!1,error:"DATABASE_INDEX_REQUIRED",message:"This view requires a database index. If you are the developer, please check the console for the index creation link."}:{success:!1,error:r.message}}},R=async e=>{try{const s=u(t,c,e),r=await p(s);return r.exists()?(console.log("âœ… Project found:",e),{success:!0,data:{id:r.id,...r.data()}}):(console.log("âŒ Project not found:",e),{success:!1,error:"Project not found"})}catch(s){return console.error("âŒ Error fetching project:",s),{success:!1,error:s.message}}},D=async(e,s)=>{try{const r=u(t,c,e);return await P(r,{...s,updatedAt:d()}),console.log("âœ… Project updated:",e),{success:!0}}catch(r){return console.error("âŒ Error updating project:",r),{success:!1,error:r.message}}},S=async e=>{try{const s=l(t,"projects",e,"phases"),a=(await i(s)).docs.map(n=>w(e,n.id));await Promise.all(a),console.log(`ğŸ§¹ Deleted ${a.length} phases for project:`,e);const o=u(t,c,e);return await m(o),console.log("âœ… Project and all its content deleted:",e),{success:!0}}catch(s){return console.error("âŒ Error deleting project:",s),{success:!1,error:s.message}}};export{R as a,q as c,S as d,A as g,D as u};
