import{r as s,j as e,u as b,a as S,B as x}from"./index-B56gB6y7.js";import{g as C,d as T}from"./projectService-BXfW4tyv.js";import{C as y}from"./Card-CxEH0R_p.js";const z=({name:n})=>{const[o,i]=s.useState(""),[p,d]=s.useState(!1),l=`Welcome, ${n||"User"}! üëã`,g=100;return s.useEffect(()=>{i(""),d(!1);let a=0;const c=setInterval(()=>{a<=l.length?(i(l.slice(0,a)),a++):(d(!0),clearInterval(c))},g);return()=>clearInterval(c)},[n,l]),e.jsxs("div",{style:{fontSize:"1.75rem",fontWeight:"700",background:"linear-gradient(90deg, var(--color-primary), #3b82f6)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",marginBottom:"var(--spacing-lg)",display:"flex",alignItems:"center",letterSpacing:"-0.02em",minHeight:"2.5rem"},children:[e.jsx("span",{children:o}),e.jsx("span",{style:{display:p?"none":"inline-block",width:"3px",height:"1.2em",backgroundColor:"var(--color-primary)",marginLeft:"6px",animation:"blink 0.8s step-end infinite",verticalAlign:"middle"}}),e.jsx("style",{children:`
                @keyframes blink {
                    from, to { opacity: 1; }
                    50% { opacity: 0; }
                }
                `})]})},P=()=>{const n=b(),{currentUser:o}=S(),[i,p]=s.useState([]),[d,l]=s.useState(!0),[g,a]=s.useState("");s.useEffect(()=>{o&&c()},[o]);const c=async()=>{if(o){l(!0),a("");try{const r=await C(o.uid);r.success?p(r.data):r.error==="DATABASE_INDEX_REQUIRED"?a("‚ö†Ô∏è Database setup in progress. Please wait a few minutes for the system to optimize or contact the administrator."):a(r.error||"Failed to fetch projects")}catch(r){console.error("Error fetching projects:",r),a("An unexpected error occurred")}finally{l(!1)}}},u=async(r,t,j)=>{if(r.stopPropagation(),!!window.confirm(`Are you sure you want to delete "${j}"?

This will delete ALL phases and daily logs associated with this project. This action cannot be undone.`))try{const m=await T(t);m.success?(alert("üöÄ Project and all associated data deleted successfully!"),c()):alert(`‚ùå Failed to delete project: ${m.error}`)}catch(m){console.error("Error deleting project:",m),alert("‚ùå An unexpected error occurred while deleting the project")}},v=i.length,h=i.filter(r=>r.status==="ongoing").length,f=r=>r?new Date(r).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}):"-";return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"var(--spacing-xl)"},children:[e.jsx("h1",{children:"Dashboard"}),e.jsx(x,{variant:"primary",onClick:()=>n("/add-project"),children:"‚ûï Add Project"})]}),e.jsx(z,{name:o==null?void 0:o.displayName}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"var(--spacing-md)",marginBottom:"var(--spacing-xl)"},children:[e.jsxs(y,{title:"Total Projects",hoverable:!0,children:[e.jsx("div",{style:{fontSize:"2.5rem",fontWeight:"600",color:"var(--color-primary)"},children:v}),e.jsx("div",{style:{color:"var(--color-text-tertiary)",fontSize:"0.875rem",marginTop:"var(--spacing-sm)"},children:"All time"})]}),e.jsxs(y,{title:"Ongoing Projects",hoverable:!0,children:[e.jsx("div",{style:{fontSize:"2.5rem",fontWeight:"600",color:"var(--color-success)"},children:h}),e.jsx("div",{style:{color:"var(--color-text-tertiary)",fontSize:"0.875rem",marginTop:"var(--spacing-sm)"},children:"Active now"})]})]}),e.jsx(y,{title:"Recent Projects",children:d?e.jsxs("div",{style:{textAlign:"center",padding:"var(--spacing-2xl)",color:"var(--color-text-secondary)"},children:[e.jsx("div",{style:{fontSize:"2rem",marginBottom:"var(--spacing-md)"},children:"‚è≥"}),e.jsx("p",{children:"Loading projects..."})]}):g?e.jsxs("div",{style:{textAlign:"center",padding:"var(--spacing-2xl)",color:"var(--color-danger)"},children:[e.jsx("div",{style:{fontSize:"2rem",marginBottom:"var(--spacing-md)"},children:"‚ö†Ô∏è"}),e.jsx("p",{children:g}),e.jsx(x,{variant:"outline",size:"small",onClick:c,style:{marginTop:"var(--spacing-md)"},children:"Retry"})]}):i.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"var(--spacing-2xl)",color:"var(--color-text-tertiary)"},children:[e.jsx("div",{style:{fontSize:"3rem",marginBottom:"var(--spacing-md)"},children:"üìã"}),e.jsx("p",{children:"No projects yet"}),e.jsx("p",{style:{fontSize:"0.875rem",marginBottom:"var(--spacing-lg)"},children:'Click "Add Project" to create your first project'}),e.jsx(x,{variant:"primary",onClick:()=>n("/add-project"),children:"‚ûï Add Your First Project"})]}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-md)"},children:i.map(r=>e.jsxs("div",{onClick:()=>n(`/project/${r.id}`),style:{padding:"var(--spacing-lg)",backgroundColor:"var(--color-bg-tertiary)",borderRadius:"var(--radius-md)",cursor:"pointer",transition:"all var(--transition-fast)",border:"1px solid transparent"},onMouseEnter:t=>{t.currentTarget.style.borderColor="var(--color-primary)",t.currentTarget.style.transform="translateX(4px)"},onMouseLeave:t=>{t.currentTarget.style.borderColor="transparent",t.currentTarget.style.transform="translateX(0)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"var(--spacing-sm)"},children:[e.jsx("div",{style:{flex:1},children:e.jsxs("h3",{style:{color:"var(--color-text-primary)",fontSize:"1.125rem",margin:0,display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[r.name,e.jsxs("span",{style:{padding:"4px 12px",backgroundColor:r.status==="ongoing"?"rgba(34, 197, 94, 0.1)":"rgba(156, 163, 175, 0.1)",color:r.status==="ongoing"?"var(--color-success)":"var(--color-text-tertiary)",borderRadius:"var(--radius-sm)",fontSize:"0.75rem",fontWeight:"500",textTransform:"capitalize"},children:[r.status==="completed"?"‚úì ":"",r.status==="ongoing"?"Ongoing":"Completed"]})]})}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-sm)"},children:e.jsx("button",{onClick:t=>u(t,r.id,r.name),style:{backgroundColor:"transparent",border:"none",cursor:"pointer",fontSize:"1.25rem",color:"var(--color-text-tertiary)",padding:"4px",borderRadius:"var(--radius-sm)",transition:"all var(--transition-fast)",display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:t=>{t.currentTarget.style.color="var(--color-danger)",t.currentTarget.style.backgroundColor="rgba(239, 68, 68, 0.1)"},onMouseLeave:t=>{t.currentTarget.style.color="var(--color-text-tertiary)",t.currentTarget.style.backgroundColor="transparent"},title:"Delete Project",children:"‚ùå"})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(130px, 1fr))",gap:"var(--spacing-md)",marginTop:"var(--spacing-md)"},children:[e.jsx("div",{children:e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-text-tertiary)",marginBottom:"4px"},children:"Start Date"})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-text-tertiary)",marginBottom:"4px"},children:"Estimated Cost"}),e.jsx("div",{style:{fontSize:"1rem",fontWeight:"600",color:"var(--color-primary)"},children:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(r.estimatedCost||0)})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-text-tertiary)",marginBottom:"4px"},children:"Start Date"}),e.jsx("div",{style:{fontSize:"1rem",fontWeight:"500",color:"var(--color-text-secondary)"},children:f(r.startDate)})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-text-tertiary)",marginBottom:"4px"},children:"Status"}),e.jsx("div",{style:{fontSize:"0.875rem",fontWeight:"500",color:"var(--color-text-secondary)",textTransform:"capitalize"},children:r.status})]})]})]},r.id))})})]})};export{P as default};
